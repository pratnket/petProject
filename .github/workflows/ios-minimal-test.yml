name: iOS Minimal Test - æœ€ç°¡å–®æ¸¬è©¦

on:
  workflow_dispatch: # åªå…è¨±æ‰‹å‹•è§¸ç™¼

jobs:
  ios-minimal-test:
    runs-on: macos-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Check iOS project structure
        run: |
          echo "ğŸ” === æª¢æŸ¥ iOS å°ˆæ¡ˆçµæ§‹ ==="
          echo "ğŸ“ ç•¶å‰ç›®éŒ„ï¼š"
          pwd
          echo ""

          echo "ğŸ“± iOS ç›®éŒ„å…§å®¹ï¼š"
          ls -la ios/
          echo ""

          echo "ğŸ“‹ Podfile å…§å®¹ï¼š"
          cat ios/Podfile
          echo ""

      - name: Test basic xcodebuild command
        run: |
          cd ios
          echo "ğŸ”¨ === æ¸¬è©¦åŸºæœ¬ xcodebuild å‘½ä»¤ ==="

          echo "ğŸ“± æ¸¬è©¦ -list å‘½ä»¤ï¼š"
          xcodebuild -project PetProject.xcodeproj -list
          echo ""

          echo "ğŸ“‹ æ¸¬è©¦ -showBuildSettings å‘½ä»¤ï¼š"
          xcodebuild -project PetProject.xcodeproj -showBuildSettings | head -20
          echo ""

      - name: Test minimal build
        run: |
          cd ios
          echo "ğŸ”¨ === æ¸¬è©¦æœ€ç°¡å–®æ§‹å»º ==="

          echo "ğŸ“± å˜—è©¦æœ€ç°¡å–®çš„æ§‹å»ºå‘½ä»¤..."
          xcodebuild -project PetProject.xcodeproj \
                     -scheme PetProject \
                     -configuration Debug \
                     -destination 'generic/platform=iOS Simulator' \
                     build
